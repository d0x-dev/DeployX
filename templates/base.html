<!doctype html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,user-scalable=yes">
  <title>{% block title %}Deploy X{% endblock %}</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">

  <style>
  :root{
    --primary:#0078ff; --primary-dark:#005bd1;
    --bg:#f7f9fc; --surface:#ffffff;
    --text:#1f2937; --text-muted:#6b7280;
    --border:rgba(0,0,0,0.08); --shadow:0 12px 32px rgba(0,0,0,0.08);
    --radius:18px; --maxw:1120px; --section:4rem;
    --gradient:linear-gradient(135deg,var(--primary) 0%,var(--primary-dark) 100%);
  }
  html[data-theme="dark"]{
    --bg:#0f1116; --surface:#16191f; --text:#e5e7eb; --text-muted:#9ca3af;
    --border:rgba(255,255,255,0.06); --shadow:0 12px 32px rgba(0,0,0,0.32);
    --gradient:linear-gradient(135deg,#0090ff 0%,#005bd1 100%);
  }

  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:var(--bg); color:var(--text);
    font-family:'Inter',system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,sans-serif;
    overflow-x:hidden; -webkit-text-size-adjust:100%; touch-action:pan-y; scroll-behavior:smooth;
  }
  a{color:var(--primary); text-decoration:none}

  .container{width:100%; max-width:var(--maxw); margin:0 auto; padding:0 1.25rem}
  .page{min-height:calc(100dvh - 64px); padding:var(--section) 0}
  @media (max-width:768px){ :root{--section:3rem}; .page{padding:2.5rem 0} }

  /* 24/7 perpetual animated blobs */
  .blobs{position:fixed; inset:0; pointer-events:none; z-index:-1; overflow:hidden}
  .blob{position:absolute; border-radius:50%; filter:blur(80px); opacity:.35; animation:float 14s infinite alternate ease-in-out}
  .blob.one{width:380px;height:380px; top:-100px; left:-120px; background:#ff6b6b; animation-delay:0s}
  .blob.two{width:420px;height:420px; bottom:-120px; right:-120px; background:#4d96ff; animation-delay:1.3s}
  .blob.three{width:260px;height:260px; top:20%; right:10%; background:#ffd93d; animation-delay:2.1s}
  @keyframes float{0%{transform:translate(0,0) scale(1)}100%{transform:translate(40px,-40px) scale(1.08)}}

  /* App bar */
  .appbar{
    position:sticky; top:0; z-index:10; backdrop-filter:blur(10px);
    background:linear-gradient(180deg, rgba(255,255,255,.78), rgba(255,255,255,0));
    border-bottom:1px solid var(--border); padding:12px 14px;
    display:flex; align-items:center; gap:12px;
  }
  html[data-theme="dark"] .appbar{
    background:linear-gradient(180deg, rgba(22,25,31,.78), rgba(22,25,31,0));
  }
  .brand{font-weight:800; font-size:1.4rem; letter-spacing:.2px; color:var(--text); text-decoration:none}
  .nav{display:none; align-items:center; gap:18px}
  .nav a{color:var(--text); opacity:.85}
  .nav a:hover{opacity:1}
  @media (min-width:900px){ .nav{display:flex} .hamb{display:none} }

  /* Theme toggle */
  .theme-toggle{
    margin-left:auto; width:44px;height:44px;border-radius:50%; border:1px solid var(--border);
    background:var(--surface); box-shadow:var(--shadow); display:inline-flex; align-items:center; justify-content:center; cursor:pointer;
    transition:transform .15s ease
  }
  .theme-toggle:active{transform:scale(.97)}
  .theme-toggle svg{width:20px;height:20px}

  /* Drawer */
  .hamb{margin-left:8px; width:44px;height:38px; border-radius:10px; border:1px solid var(--border);
        background:var(--surface); display:inline-flex; align-items:center; justify-content:center; cursor:pointer}
  .hamb svg{width:22px;height:22px}
  .drawer{position:fixed; inset:0; z-index:11; pointer-events:none}
  .drawer.open{pointer-events:auto}
  .scrim{position:absolute; inset:0; background:rgba(0,0,0,.46); opacity:0; transition:opacity .22s}
  .drawer.open .scrim{opacity:1}
  .sheet{
    position:absolute; right:0; top:0; height:100%; width:min(86vw,360px); overflow:auto;
    background:var(--surface); border-left:1px solid var(--border); backdrop-filter:blur(12px);
    transform:translate3d(100%,0,0); transition:transform .24s cubic-bezier(.2,.8,.2,1);
    padding:16px;
  }
  .drawer.open .sheet{transform:translate3d(0,0,0)}
  .sheet h3{margin:6px 0 12px; font-size:1.06rem}
  .menu{display:flex; flex-direction:column; gap:8px}
  .menu a{display:flex; align-items:center; gap:10px; padding:12px; border-radius:12px; border:1px solid var(--border); background:var(--surface)}
  .menu a:hover{background:rgba(0,0,0,.04)}
  html[data-theme="dark"] .menu a:hover{background:rgba(255,255,255,.06)}
  .menu svg{width:18px;height:18px}

  /* Cards + buttons */
  .card{background:var(--surface); border:1px solid var(--border); border-radius:var(--radius); box-shadow:var(--shadow); padding:1.6rem 1.4rem; transition:transform .25s, box-shadow .25s}
  .card:hover{transform:translateY(-2px); box-shadow:0 16px 40px rgba(0,0,0,0.14)}
  .btn{display:inline-flex; align-items:center; justify-content:center; gap:.45rem; padding:.9rem 1.2rem; border-radius:12px; border:none; cursor:pointer; font-weight:600; transition:all .25s ease; font-size:.975rem; box-shadow:var(--shadow); color:#fff; background:var(--gradient)}
  .btn:hover{filter:brightness(1.05)}
  .btn-ghost{background:var(--surface); border:1px solid var(--border); color:var(--text)}
  .btn-ghost:hover{background:rgba(0,0,0,.04)}
  html[data-theme="dark"] .btn-ghost:hover{background:rgba(255,255,255,.06)}

  /* Forms */
  label{display:flex; flex-direction:column; gap:.45rem; margin:.6rem 0}
  input{background:var(--surface); border:1px solid var(--border); border-radius:12px; padding:.8rem 1rem; color:var(--text); outline:none}
  input:focus{box-shadow:0 0 0 3px rgba(0,120,255,.14)}

  /* Flash */
  .flash-wrap{display:grid; gap:8px; margin:1rem 0}
  .flash{padding:.85rem 1rem; border-radius:12px; border:1px solid var(--border)}
  .flash.success{background:#e9fce9}
  .flash.danger{background:#ffe9ee}
  .flash.warning{background:#fff6e6}
  .flash.info{background:#e8f4ff}

  /* Logs */
  .logpane{background:#0b0f14; color:#e7ecf3; border:1px solid #243; padding:12px; height:60vh; overflow:auto; border-radius:12px; font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size:13px}
  .badge{display:inline-flex; align-items:center; gap:8px; padding:10px 12px; border-radius:12px; background:var(--surface); border:1px solid var(--border); font-family:ui-monospace,Menlo,Consolas,monospace; color:var(--text); text-decoration:none; word-break:break-all}
  .dot{width:10px;height:10px;border-radius:50%}
  .dot.gray{background:#6c7280}
  .dot.amber{background:#fbbf24}
  .dot.green{background:#34d399}
  </style>
</head>
<body>

  <!-- 24/7 animated blobs -->
  <div class="blobs" aria-hidden="true">
    <div class="blob one"></div>
    <div class="blob two"></div>
    <div class="blob three"></div>
  </div>

  <!-- Header -->
  <header class="appbar">
    <a class="brand" href="{{ url_for('dashboard') }}">Deploy X</a>

    <nav class="nav" aria-label="Primary">
      {% if session.get('user') %}
        <a href="{{ url_for('dashboard') }}">Dashboard</a>
        <a href="{{ url_for('deploy') }}">Create</a>
        <a href="{{ url_for('projects') }}">Upload</a>
        <a href="{{ url_for('logout') }}">Logout</a>
      {% else %}
        <a href="{{ url_for('login') }}">Login</a>
        <a href="{{ url_for('signup') }}">Sign up</a>
      {% endif %}
    </nav>

    <!-- Theme toggle -->
    <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79Z"/></svg>
    </button>

    <!-- mobile hamburger -->
    <button class="hamb" id="hamb" aria-label="Menu" aria-controls="drawer" aria-expanded="false">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round">
        <path d="M4 7h16M4 12h16M4 17h16"/>
      </svg>
    </button>
  </header>

  <!-- Drawer -->
  <aside class="drawer" id="drawer" aria-hidden="true">
    <div class="scrim" id="scrim"></div>
    <div class="sheet" role="dialog" aria-label="Menu">
      <h3>Menu</h3>
      <nav class="menu">
        {% if session.get('user') %}
          <a href="{{ url_for('dashboard') }}">Dashboard</a>
          <a href="{{ url_for('deploy') }}">Create project</a>
          <a href="{{ url_for('projects') }}">Upload files</a>
          <a href="{{ url_for('logout') }}">Logout</a>
        {% else %}
          <a href="{{ url_for('login') }}">Login</a>
          <a href="{{ url_for('signup') }}">Sign up</a>
        {% endif %}
      </nav>
    </div>
  </aside>

  <main class="page">
    <div class="container">
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          <div class="flash-wrap">
            {% for category, msg in messages %}
              <div class="flash {{ category }}">{{ msg }}</div>
            {% endfor %}
          </div>
        {% endif %}
      {% endwith %}
      {% block content %}{% endblock %}
    </div>
  </main>

  <script>
  // Theme toggle
  (function(){
    const root=document.documentElement, btn=document.getElementById('themeToggle');
    const saved=localStorage.getItem('theme');
    const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
    const set = m=>{
      root.setAttribute('data-theme', m);
      localStorage.setItem('theme', m);
      btn.innerHTML = m==='dark'
        ? '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6"><circle cx="12" cy="12" r="4"/><path d="M12 2v2m0 16v2m10-10h-2M4 12H2m15.5-7.5-1.4 1.4M7.9 17.9l-1.4 1.4m12.6 0-1.4-1.4M7.9 6.1 6.5 4.7"/></svg>'
        : '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79Z"/></svg>';
    };
    set(saved || (prefersDark?'dark':'light'));
    btn.addEventListener('click',()=>set(root.getAttribute('data-theme')==='light'?'dark':'light'),{passive:true});
  })();

  // Drawer
  (function(){
    const hamb=document.getElementById('hamb'), drawer=document.getElementById('drawer'), scrim=document.getElementById('scrim');
    if(!hamb||!drawer) return;
    const open=()=>{requestAnimationFrame(()=>{drawer.classList.add('open'); drawer.setAttribute('aria-hidden','false'); hamb.setAttribute('aria-expanded','true');});};
    const close=()=>{drawer.classList.remove('open'); drawer.setAttribute('aria-hidden','true'); hamb.setAttribute('aria-expanded','false');};
    hamb.addEventListener('click',open,{passive:true}); scrim.addEventListener('click',close,{passive:true});
    window.addEventListener('keydown',e=>{if(e.key==='Escape') close();},{passive:true});
  })();
  </script>
</body>
</html>
